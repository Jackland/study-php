<div role="tabpanel" class="tab-pane active">
  <div class="bg-white p-2">
    {% if data != null %}

    <div class="table-responsive">
      <table class="table  table-hover" id="history_list_table" style="color: #333333">
        <thead>
        <tr style="color: #333333">
          <th class="text-center"> #</th>
          <th class="text-left">
            {% if column == 'payment_time' %}
              {% if sort == 'desc' %}
                <i class="fa fa-arrow-down" style="cursor: pointer" onclick="historyListSort('payment_time','asc')" aria-hidden="true"></i>
              {% else %}
                <i class="fa fa-arrow-up" style="cursor: pointer" onclick="historyListSort('payment_time','desc')" aria-hidden="true"></i>
              {% endif %}
            {% else %}
              <i class="fa fa-arrow-down" style="cursor: pointer;opacity: 0.4" onclick="historyListSort('payment_time','asc')" aria-hidden="true"></i>
            {% endif %}
            {{ column_payment_time }}

          </th>
          <th class="text-left">{{ column_bill }}</th>
          <th class="text-right">
            {% if column == 'amount_due' %}
              {% if sort == 'desc' %}
                <i class="fa fa-arrow-down" style="cursor: pointer" onclick="historyListSort('amount_due','asc')" aria-hidden="true"></i>
              {% else %}
                <i class="fa fa-arrow-up" style="cursor: pointer" onclick="historyListSort('amount_due','desc')" aria-hidden="true"></i>
              {% endif %}
            {% else %}
              <i class="fa fa-arrow-down" style="cursor: pointer;opacity: 0.4" onclick="historyListSort('amount_due','asc')" aria-hidden="true"></i>
            {% endif %}

            {{ column_amount_due }}
          </th>
          <th class="text-right">
            {% if column == 'paid_amount' %}
              {% if sort == 'desc' %}
                <i class="fa fa-arrow-down" style="cursor: pointer" onclick="historyListSort('paid_amount','asc')" aria-hidden="true"></i>
              {% else %}
                <i class="fa fa-arrow-up" style="cursor: pointer" onclick="historyListSort('paid_amount','desc')" aria-hidden="true"></i>
              {% endif %}
            {% else %}
                <i class="fa fa-arrow-down" style="cursor: pointer;opacity: 0.4" onclick="historyListSort('paid_amount','asc')" aria-hidden="true"></i>
            {% endif %}
            {{ column_paid_amount }}
          </th>
          <th class="text-right"  style="width: 15%">{{ column_transaction_fee }}</th>
          <th class="text-left"  style="width: 15%">{{ column_payment_method }}</th>
          <th class="text-left" style="width: 10%">{{ column_action }}</th>
        </tr>
        </thead>
        <tbody>
            {% for key,value in data %}
                <tr >
                <td class="text-center">{{ key + 1 }}</td>
                <td class="text-left">
                 {{ value.payment_time_pre }}
                  <br/>
                  <span style="opacity:0.4;">{{ value.payment_time_suf }}</span></td>
                <td class="text-left">
                  {% for ks,vs in value.paid_month_list %}
                    <span style="color:#0C99D6;font-size: 13px;cursor: pointer" onclick="downloadHistoryData('{{ download_data }}','{{ ks }}')">
                      {{ vs  }}
                    </span>
                  {% endfor %}
                </td>
                <td class="text-right">
                  <span style="color:#4E648A;">
                    {{ value.amount_due_show }}
                  </span>
                </td>
                <td class="text-right" style="color:#4E648A;">
                  {{ value.paid_amount_show }}
                  <i class="giga icon-V10-wenhaotishi" aria-hidden="true" data-toggle="tooltip"
                                                   title="{{ value.deduction_show }} off on storage fees has been offered by Giga Cloud.">
                  </i>
                </td>
                <td class="text-right">
                  <span style="color:#4E648A;">
                    {{ value.transaction_fee_show }}
                  </span></td>
                <td class="text-left"> </td>
                <td class="text-left" style="width: 10%;text-align: left">
                  <button  type="button" class="btn"  onclick="getBillUrl('{{ value.id }}')"  style="margin-right: 5px;margin-bottom: 3px;" data-toggle="tooltip" >
                    <i class="giga icon-action-preview" aria-hidden="true"></i>
                  </button></td>
              </tr>
            {% endfor %}
        </tbody>
      </table>
    </div>
    <div id="table_bill_0" class="yapiskan_history" style="margin-top: -20px;color: #333333"  >
      <table class="table  table-hover" >
        <tr>
          <td colspan="5" class="text-right"></td>
          <td style="border-bottom:#DDDDDD solid 1px;width: 15%" class="text-right">{{ column_total_paid_amount }}</td>
          <td class="text-right" style="border-bottom:#DDDDDD solid 1px;color: red;width: 10%">{{ total_paid }}</td>
          <td style="border-bottom:#DDDDDD solid 1px;width: 10%" ></td>
        </tr>
      </table>
    </div>

    {% else %}
      <div class="table-responsive">
        <table class="table  table-hover" id="history_list_table" style="color: #333333">
          <thead>
          <tr style="color: #333333">
            <th class="text-center"> #</th>
            <th class="text-left">{{ column_payment_time }}</th>
            <th class="text-left">{{ column_bill }}</th>
            <th class="text-right">{{ column_amount_due }}</th>
            <th class="text-right">{{ column_paid_amount }}</th>
            <th class="text-right"  style="width: 15%">{{ column_transaction_fee }}</th>
            <th class="text-left"  style="width: 15%">{{ column_payment_method }}</th>
            <th class="text-left" style="width: 10%">{{ column_action }}</th>
          </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" colspan="8"><span style="color: #000000;opacity:0.4;">No records.</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    {% endif %}
  </div>
</div>




<style>
  .month:hover {
    color: #999999;
  }
</style>
<script>
  var arr_history = new Array();
  $(function(){
    var ss_new = $(document).scrollTop();

    $(window).scroll(function(){
      var s_new = $(document).scrollTop();

      if(arr_history[0] + 400 - s_new > 900){
        $('.yapiskan_history').addClass('yya_history');
      }else{
        $('.yapiskan_history').removeClass('yya_history');
      }
    });

  });
  $('#history_li').click(function (e) {
    e.preventDefault();
    $('.tab-content').children().removeClass('active');
    $('#tab-history').addClass('active');
    $('#bill_li').removeClass('active');
    $('#history_li').addClass('active');
    arr_history[0] = $('#history_list_table').height();

  });
  function getBillUrl(id) {
    var url = 'index.php?route=account/storage_fee_management/paidBillList&id=' + id;
//    window.location.href = url;
    window.open(url,'_blank');
  }

  function downloadHistoryData(url,id) {
    window.location.href = url + '&type=1&id=' + id;
  }

  function historyListSort(column,sort) {
    layer.load();
    var url_load = 'index.php?route=account/storage_fee_management/historyList&column=' + column + '&sort=' + sort;
    $('#mapping-history').load(url_load,function(responseTxt,statusTxt,xhr){
      if(statusTxt=="success"){
        layer.closeAll('loading');
      }
    });

  }


</script>
<style>
  .yapiskan_history{

    color:white;
    width: 100%;
    text-align:left;
    transition:top 1.5s;
  }
  .yya_history{
    background-color:#F5F5F5;
    position:fixed;
    bottom:0;
    width: 1140px;
    height:34px;
  }
</style>



