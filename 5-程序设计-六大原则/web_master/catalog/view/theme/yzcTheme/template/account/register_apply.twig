{{ header }}
<style>
  .myrequired:before {
    content: '* ';
    color: #F00;
    font-weight: bold;

  }
</style>
<div id="account-register" class="container">
  <ul class="breadcrumb">
    {% for breadcrumb in breadcrumbs %}
      <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
    {% endfor %}
  </ul>
  {% if error_warning %}
    <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}</div>
  {% endif %}
  <div class="row">{{ column_left }}
    {% if column_left and column_right %}
      {% set class = 'col-sm-6' %}
    {% elseif column_left or column_right %}
      {% set class = 'col-sm-9' %}
    {% else %}
      {% set class = 'col-sm-12' %}
    {% endif %}
    <div id="content" class="{{ class }}">{{ content_top }}
      {#<h1>{{ heading_title }}</h1>#}
      <p style="float: right">{{ text_account_already }}</p>
      <div style="margin-top: 30px">
        <form action="{{ action }}" method="post" enctype="multipart/form-data" class="form-horizontal"
              onsubmit="return vaild()">
          <fieldset id="account">
            <legend>Buyer Details</legend>
            {#First Name#}
            <div class="form-group required">
              <label class="col-sm-2 control-label" for="input-firstname">{{ entry_firstname }}</label>
              <div class="col-sm-10 ipt">
                <input type="text" name="firstname" value="{{ firstname }}" placeholder="{{ entry_firstname }}"
                       id="input-firstname" class="form-control"/>
                {% if error_firstname %}
                  <div class="text-danger">{{ error_firstname }}</div>
                {% endif %}
              </div>
            </div>
            {#Last Name#}
            <div class="form-group required">
              <label class="col-sm-2 control-label" for="input-lastname">{{ entry_lastname }}</label>
              <div class="col-sm-10 ipt">
                <input type="text" name="lastname" value="{{ lastname }}" placeholder="{{ entry_lastname }}"
                       id="input-lastname" class="form-control"/>
                {% if error_lastname %}
                  <div class="text-danger">{{ error_lastname }}</div>
                {% endif %}
              </div>
            </div>
            {#E-mail#}
            <div class="form-group required" style="display: flex">
              {% if column_right %}
                <label class="control-label" for="input-email" style="margin-left: 27px">Email(Login Name)</label>
              {% else %}
                <label class="col-sm-2 control-label" for="input-email">Email(Login Name)</label>
              {% endif %}
              <div class="col-sm-10 ipt">
                <input type="email" name="email" value="{{ email }}" placeholder="{{ entry_email }}" id="input-email"
                       class="form-control"/>
                {% if error_email %}
                  <div class="text-danger">{{ error_email }}</div>
                {% endif %}
              </div>
            </div>
            {#Telephont#}
            <div class="form-group required">
              <label class="col-sm-2 control-label" for="input-telephone">Telephone</label>
              <div class="col-sm-10 ipt">
                <input type="tel" name="telephone" value="{{ telephone }}" placeholder="{{ entry_telephone }}"
                       id="input-telephone" class="form-control"/>
                {% if error_telephone %}
                  <div class="text-danger">{{ error_telephone }}</div>
                {% endif %}
              </div>
            </div>
            {#Source#}
            <div class="form-group required">
              <label class="col-sm-2 control-label" for="input-source" id="passwordLabel">{{ entry_source }}</label>
              <div class="col-sm-10 ipt">
                <input type="text" name="source" value="{{ source }}" placeholder="{{ entry_source }}" id="input-source"
                       class="form-control"/>
                {% if error_source %}
                  <div class="text-danger">{{ error_source }}</div>
                {% endif %}
              </div>
            </div>
            {#Street Address#}
            <div class="form-group">
              <label class="col-sm-2 control-label" for="input-confirm">Street Address</label>
              <div class="col-sm-10 ipt">
                <input type="text" name="street" value="{{ street }}" placeholder="{{ entry_address }}"
                       id="input-street" class="form-control"/>
                {% if error_street %}
                  <div class="text-danger">{{ error_street }}</div>
                {% endif %}
              </div>
            </div>
            <div class="form-group">
              {#Country#}
              <label class="col-sm-2 control-label myrequired" for="input-confirm">Country</label>
              <div class="col-sm-4 ipt">
                <select name="address[country_id]" id="input-country"
                        onchange="country(this,'{{ address.zone_id }}', {{ zone_id }});"
                        class="form-control">
                  <option value="">----{{ text_select }}----</option>
                  {% for country in countries %}
                    <option
                      value="{{ country.country_id }}" {% if country_id == country.country_id %} selected {% endif %}>{{ country.name }}</option>
                  {% endfor %}
                </select>
                {% if error_country %}
                  <div class="text-danger">{{ error_country }}</div>
                {% endif %}
              </div>
              {#State#}
              <label class="col-sm-2 control-label" for="input-confirm">State/Region/Province</label>
              <div class="col-sm-4">
                <select name="address[zone_id]" id="input-zone" class="form-control">

                </select>
              </div>
            </div>
            <div class="form-group">
              {#City#}
              <label class="col-sm-2 control-label" for="input-confirm">City/Town</label>
              <div class="col-sm-4 ipt">
                <input type="text" name="city" value="{{ city }}" placeholder="{{ entry_city }}" id="input-city"
                       class="form-control"/>
                {% if error_city %}
                  <div class="text-danger">{{ error_city }}</div>
                {% endif %}
              </div>
              {#ZipCode#}
              <label class="col-sm-2 control-label" for="input-confirm">ZIP/Postal Code</label>
              <div class="col-sm-4 ipt">
                <input type="text" name="zip" value="{{ zip }}" placeholder="{{ entry_zip }}" id="input-zip"
                       class="form-control"/>
                {% if error_zip %}
                  <div class="text-danger">{{ error_zip }}</div>
                {% endif %}
              </div>
            </div>
            {#Remark#}
            <div class="form-group">
              <label class="col-sm-2 control-label" for="input-remark">Remark</label>
              <div class="col-sm-10 ipt">
                <textarea name="remark" id="input-remark" class="form-control" maxlength="600"
                          style="height: 120px">{{ remark }}</textarea>
                {% if error_remark %}
                  <div class="text-danger">{{ error_remark }}</div>
                {% endif %}
              </div>
            </div>
          </fieldset>

          <div class="buttons">
            <div class="pull-right">
              <input onclick="$(this).button('loading');" type="submit" value="{{ button_continue }}" class="btn btn-primary"/>
            </div>
          </div>
        </form>
      </div>
      {{ content_bottom }}</div>
    {{ column_right }}
  </div>
</div>
<script>

  $(document).ready(function () {
    // Highlight any found errors
    $('.text-danger').each(function () {
      var element = $(this).parent().parent();

      if (element.hasClass('has-error')) {
        element.removeClass('has-error');
      }
      element = $(this).parent();
      if (element.hasClass('ipt')) {
        element.addClass('has-error');
      }
    });
  });
  // function addressView() {
  //     var country = $('#input-country').find("option:selected").text();
  //     var status = $('#input-zone').find("option:selected").text();
  //     var city = $('#input-city').val();
  //     var zip = $('#input-zip').val();
  //     var street = $('#input-street').val();
  //     var address = street+","+city+","+status+","+country+","+zip;
  //     $('#input-billingAddress').val(address);
  // }

  function vaild() {
    if ($('#invitationError').css('display') == 'block' || $('#dateErr1').css('display') == 'block') {
      return false;
    } else {
      return true;
    }
  }

  function country(element, index, zone_id) {
    $.ajax({
      url: 'index.php?route=account/register_apply/country&user_token={{ user_token }}&country_id=' + element.value,
      dataType: 'json',
      beforeSend: function () {
        $('select[name=\'address[country_id]\']').prop('disabled', true);
      },
      complete: function () {
        $('select[name=\'address[country_id]\']').prop('disabled', false);
      },
      success: function (json) {
        if (json['postcode_required'] == '1') {
          $('input[name=\'address[' + index + '][postcode]\']').parent().parent().addClass('required');
        } else {
          $('input[name=\'address[' + index + '][postcode]\']').parent().parent().removeClass('required');
        }

        var html = '<option value="">----{{ text_select }}----</option>';

        if (json['zone'] && json['zone'] != '') {
          for (var i = 0; i < json['zone'].length; i++) {
            html += '<option value="' + json['zone'][i]['zone_id'] + '"';

            if (json['zone'][i]['zone_id'] == zone_id) {
              html += ' selected="selected"';
            }

            html += '>' + json['zone'][i]['name'] + '</option>';
          }
        } else {
          html += '<option value="0">{{ text_none }}</option>';
        }

        $('select[name=\'address[zone_id]\']').html(html);
      },
      error: function (xhr, ajaxOptions, thrownError) {
        alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
      }
    });
  }

  $('select[name$=\'[country_id]\']').trigger('change');
</script>
{{ footer }} 