{{ header }}
<script src="catalog/view/javascript/jquery/datetimepicker/moment/moment.min.js" type="text/javascript"></script>
<script src="catalog/view/javascript/jquery/datetimepicker/moment/moment-with-locales.min.js" type="text/javascript"></script>
<script src="catalog/view/javascript/jquery/datetimepicker/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
<link href="catalog/view/javascript/jquery/datetimepicker/bootstrap-datetimepicker.min.css" type="text/css" rel="stylesheet" media="screen" />
<style>
  .flag-margin-order{
    color: #FF784E;
    margin-left: 5px;
  }
</style>

<div id="page-purchase-order-management" class="page-seller-portal">
  {#菜单#}
  {% include 'giga/template/_parts/breadcrumb_simple.twig' %}
  {#END 菜单#}


  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1>{{ column_upload_records }}</h1>
      </div>
    </div>


    <div class="row mb-4">
      <div class="col-md-12">
        <div class="tab-content main">
          <div role="tabpanel" class="tab-pane active" id="upload">
            <div class="bg-white p-2">
              {#搜索#}
              <div class="filter-wrapper form-wrapper mt-3 mb-3">
                <form action="" method="get" enctype="multipart/form-data" id="form-order">
                  <div class="col-sm-4">
                    <div class="form-group">
                      <input type="hidden" name="page"  id="page" value="{{ page }}">
                      <label for="input-orderDate-from" >{{ column_creation_from}}</label>
                      <div class="datetimepicker-range">
                        <div class="datetimepicker">
                          <input type="text" name="filter_orderDate_from" value="" class="form-control"
                                 id="input-orderDate-from" placeholder="Pick A Date" data-date-format="YYYY-MM-DD">
                          <span class="title">From</span>
                          <span class="icon"><i class="giga icon-date-icon"></i></span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-4">
                    <div class="form-group">
                      <label for="input-date-added">{{ column_creation_to}}</label>
                      <div class="datetimepicker-range">
                        <div class="datetimepicker">
                          <input type="text" name="filter_orderDate_to" value="" class="form-control" id="input-orderDate-to" placeholder="Pick A Date"
                                 data-date-format="YYYY-MM-DD">
                          <span class="title">To</span>
                          <span class="icon"><i class="giga icon-date-icon"></i></span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-4">
                    <div class="form-group pull-right">
                      <label>&nbsp;</label>
                      <div>
                        <button type="button" onclick="filter()" class="btn btn-primary pull-left">{{ button_filter}}</button>
                      </div>
                    </div>
                  </div>
                </form>
              </div>

              {#table#}
              <table class="table main table-hover">
                <thead>
                <tr>
                  <th class="text-left">File Name</th>
                  <th class="text-left">Creation Time</th>
                  <th class="text-left">Status </th>
                </tr>
                </thead>

                <tbody>
                {% if historys %}
                  {% for history in historys %}
                    <tr>
                      <td class="text-left"><a  style="cursor: pointer" onclick=" window.location.href='{{ history.file_path }}'">{{ history.file_name }}&nbsp;<i class="giga icon-table-download"></i></a></td>
                      <td class="text-left">{{ history.create_time }}</td>
                      <td>
                        {% if history.handle_status == 1 %}
                          <i class="giga icon-action-confirm-and-agree" aria-hidden="true" style="color: #00CC00"></i>
                        {% else %}
                          <i class="giga icon-action-warning" aria-hidden="true" style="color: #DB0000;"></i>
                        {% endif %}
                        &nbsp;{{ history.handle_message }}
                      </td>
                    </tr>
                  {% endfor %}
                {% else %}
                  <tr>
                    <td class="text-left" colspan="3">{{ text_no_results}}</td>
                  </tr>
                {%  endif %}
                </tbody>
              </table>

              <div class="row">
                <div class="text-right col-sm-12">{{ pagination }}</div>
                {#<div class="text-right col-sm-6">{{ results }}</div>#}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  $(document).ready(function () {
    let filter_orderDate_from = '{{ filter_orderDate_from }}';
    let filter_orderDate_to = '{{ filter_orderDate_to }}';
    if(filter_orderDate_from){
      filter_orderDate_from = filter_orderDate_from.substring(0,10);
      $('#input-orderDate-from').val(filter_orderDate_from);
    }
    if(filter_orderDate_to){
      filter_orderDate_to = filter_orderDate_to.substring(0,10);
      $('#input-orderDate-to').val(filter_orderDate_to);
    }
  });
  $('#input-orderDate-from').datetimepicker({
    pickDate: true,
    pickTime: false,
    format: 'YYYY-MM-DD'
  });
  $('#input-orderDate-to').datetimepicker({
    pickDate: true,
    pickTime: false,
    format: 'YYYY-MM-DD 23:59:59'
  });
  function filter() {
      //暂时不写

//      var start_time = $('#input-orderDate-from').val();
//      var end_time = $('#input-orderDate-to').val();
//      if(start_time !='' && end_time !=''){
//          var startTime = start_time.replace(/-/g,'/');
//          var endTime = end_time.replace(/-/g,'/');
//          var startTime = new Date(startTime);
//          var startTimes = startTime.getTime();
//          var endTimeCompare = new Date(endTime).toDateString() ;
//          var endTime = new Date(endTime);
//          if(endTime > new Date()){
//            alert('Time exceeded limits.');
//            return false;
//          }
//          var endTimes = endTime.getTime();
//          if(endTimes<startTimes){
//            alert('Incorrect time input.');
//            return false;
//          }
//      }else if(start_time =='' && end_time ==''){
//
//      }else{
//          alert('Please fill in the time.')
//      }
      let page_url = '{{ submit_url }}';
//      page_url += '&page='+$('#page').val();
      let filter_orderDate_from =$('#input-orderDate-from').val();
      if (filter_orderDate_from) {
        page_url += '&filter_orderDate_from=' + encodeURIComponent(filter_orderDate_from + ' 00:00:00');
      }
      let filter_orderDate_to = $('#input-orderDate-to').val();
      if(filter_orderDate_to){
        page_url += '&filter_orderDate_to=' + encodeURIComponent(filter_orderDate_to + ' 23:59:59');
      }
      window.location.href = page_url;

  }
</script>
{{ footer }}