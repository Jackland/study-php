{{ header }}{{ separate_column_left }}
<style>
  .dropdown-menu {
    position: absolute !important;
  }
  .review-filter label[for="input-status"] {
    margin-left:15%;
  }
  .review-filter .input-group-btn > .button {
    line-height: 20px;
  }
  @media only screen and (max-width: 767px) {
    #input-status {
      margin-left: 0;
      margin-right: 0;
      width: 95%;
    }
    .oc2 .form-horizontal .form-group label {
      width: auto;
    }
    .oc2 fieldset label + input.form-control, #input-status, .oc2 .form-horizontal .form-group label + div {
      width: 95%;
      float: none;
      /* check */
    }
    .pull-right {
      float: right;
      /* check */
    }
    #content #button-filter {
      margin: 15px 5%;
    }
    .review-filter label[for="input-status"] {
      margin-left: 0;
    }
    .review-filter .date > input {
      min-width: auto;
    }
    .table-responsive {
      overflow: auto;
    }
  }
  @media only screen and (max-width: 480px) {
    #input-status {
      margin-left: 0;
      margin-right: 0;
      width: 100%;
    }
    button[onclick="clearfilter();"] {
      margin-top: 0px !important;
    }
    fieldset .table-responsive {
      overflow: auto !important;
    }
    .pull-right {
      float: none !important;
      /* check */
    }
    #content #button-filter {
      margin-left: 0;
      margin-right: 0;
    }
  }
  @media only screen and (min-width: 480px) {
    .col-sm-4{
      width: 33.33%;
    }
    .review-filter .row:first-child{
      display: inline-flex;
    }
  }
</style>
{% if separate_view is defined and separate_view %}
<div class="container-fluid" id="content" style="margin-left: 15%;" >
    {% else %}
  <div class="container">
      {% endif %}
    <ul class="breadcrumb">
      {% for breadcrumb in breadcrumbs %}
        <li>
          <a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a>
        </li>
      {% endfor %}
    </ul>
      <h1>RMA Management</h1>
      <legend></legend>
      <div class="row">
          <div id="filter-review" class="col-sm-12 hidden-sm hidden-xs">
              <div class="panel panel-default">
                  <div class="panel-heading">
                      <h3 class="panel-title"><i class="fa fa-filter"></i> {{ text_filter }}</h3>
                  </div>
                  <div  class="panel-body">
                      <div class="col-sm-4">
                      <div class="form-group">
                          <label class="control-label" for="input-product">{{ entry_rma_id }}</label>
                          <input type="text" name="filter_rma_id" value="{{ filter_rma_id }}" placeholder="{{ entry_rma_id }}" id="input-rmaId" class="form-control" />
                      </div>
                      </div>
                      <div class="col-sm-4">
                      <div class="form-group">
                          <label class="control-label" for="input-author">{{ entry_rma_date }}</label>
                              <div class="input-group datetime">
                                    <span class="input-group-addon ">
                                        <i class="fa fa-calendar"></i>
                                    </span>
                                  <input type="text" class="form-control date"  placeholder="from" name="filter_rmaDateFrom" value="{{ filter_rmaDateFrom }}" />
                                  <span class="input-group-addon ">
                                        <i class="fa fa-calendar"></i>
                                    </span>
                                  <input type="text" class="form-control date"   placeholder="to" name="filter_rmaDateTo" value="{{ filter_rmaDateTo }}" />
                              </div>
                          </div>
                      </div>
                      <div class="col-sm-4">
                      <div class="form-group">
                          <label class="control-label" for="input-status">{{ entry_mpn }}</label>
                          <input name="filter_mpn" id="input-mpn" class="form-control" value="{{ filter_mpn }}">

                          </input>
                      </div>
                      </div>
                      <div class="col-sm-4">
                      <div class="form-group">
                          <label class="control-label" for="input-date-added">{{ entry_status }}</label>
                          <select name="filter_status" id="input-status" class="form-control">
                                <option value="0">--Select--</option>
                              {% if filter_status == 1 %}
                                  <option value="1" selected>Applied</option>
                              {% else %}
                                  <option value="1">Applied</option>
                              {% endif %}
                              {% if filter_status == 3 %}
                                  <option value="3" selected>Pending</option>
                              {% else %}
                                  <option value="3">Pending</option>
                              {% endif %}
                              {% if filter_status == 2 %}
                                  <option value="2" selected>Processed</option>
                              {% else %}
                                  <option value="2">Processed</option>
                              {% endif %}
                              {% if filter_status == 4 %}
                                  <option value="4" selected>Canceled</option>
                              {% else %}
                                  <option value="4">Canceled</option>
                              {% endif %}
                          </select>
                      </div>
                      </div>
                      <div class="col-sm-4">
                          <div class="form-group">
                              <label class="control-label" for="input-author">{{ entry_processed_date }}</label>
                              <div class="input-group datetime">
                                    <span class="input-group-addon ">
                                        <i class="fa fa-calendar"></i>
                                    </span>
                                  <input type="text" class="form-control date"  placeholder="from" name="filter_processedDateFrom" value="{{ filter_processedDateFrom }}" />
                                  <span class="input-group-addon ">
                                        <i class="fa fa-calendar"></i>
                                    </span>
                                  <input type="text" class="form-control date"   placeholder="to" name="filter_processedDateTo" value="{{ filter_processedDateTo }}" />
                              </div>
                          </div>
                      </div>
                      <div class="col-sm-4">
                          <div class="form-group">
                              <label class="control-label" for="input-date-added">{{ entry_item_name }}</label>
                              <input name="filter_item_name" id="input-item-name" class="form-control" value="{{ filter_item_name}}">

                              </input>
                          </div>
                      </div>
                      <div class="col-sm-4">
                          <div class="form-group">
                              <label class="control-label" for="input-date-added">{{ entry_nick_name }}</label>
                              <input name="filter_nick_name" id="input-nick-name" class="form-control" value="{{ filter_nick_name }}">

                              </input>
                          </div>
                      </div>
                      <div class="col-sm-2">
                          <div class="form-group">
                              <label class="control-label" for="input-date-added">{{ entry_apply_for_reshipment }}</label>
                              <select name="filter_apply_for_reshipment" id="input-apply-for-reshipment" class="form-control">
                                  <option value="-1">--Select--</option>
                                  {% if filter_apply_for_reshipment == 0 %}
                                      <option value="0" selected>No</option>
                                  {% else %}
                                      <option value="0">No</option>
                                  {% endif %}
                                  {% if filter_apply_for_reshipment == 1 %}
                                      <option value="1" selected>Yes</option>
                                  {% else %}
                                      <option value="1">Yes</option>
                                  {% endif %}
                              </select>
                          </div>
                      </div>
                      <div class="col-sm-2">
                          <div class="form-group">
                              <label class="control-label" for="input-date-added">{{ entry_apply_for_refound }}</label>
                              <select name="filter_apply_for_refound" id="input-apply-for-refound" class="form-control">
                                  <option value="-1">--Select--</option>
                                  {% if filter_apply_for_refound == 0 %}
                                      <option value="0" selected>No</option>
                                  {% else %}
                                      <option value="0">No</option>
                                  {% endif %}
                                  {% if filter_apply_for_refound == 1 %}
                                      <option value="1" selected>Yes</option>
                                  {% else %}
                                      <option value="1">Yes</option>
                                  {% endif %}
                              </select>
                          </div>
                      </div>

                      <div class="col-sm-4">
                      <div class="form-group text-right" style="margin-top: 5%">
                          <button type="button" id="button-filter" class="btn btn-primary btn1" data-loading-text="Loading..." ><i class="fa fa-search"></i> Filter</button>
                          <a onclick="refilter();" class="btn btn-default btn1"> <i class="fa fa-refresh"></i> </a>
                          <button onclick="downloadRmaHistory();" class="btn btn-default" data-toggle="tooltip" title="" data-original-title="">
                              <i class="fa fa-download"></i></button>
                      </div>
                      </div>
                  </div>
              </div>
          </div>
          <div class="col-sm-12">
              <div class="panel panel-default">
                  <div class="panel-heading">
                      <h3 class="panel-title"><i class="fa fa-list"></i> {{ text_list }}</h3>
                  </div>
                  <div class="panel-body">
                      <form action="{{ delete }}" method="post" enctype="multipart/form-data" id="form-review">
                          <div class="table-responsive">
                              <table class="table table-hover table-bordered table-striped" style="table-layout:fixed;">
                                  <thead>
                                  <tr>
                                      <td style="width: 30px;" class="text-center">{{ column_no }}</td>
                                      <td class="text-left" >{{ column_buyer }}</td>
                                      <td class="text-left" width="120px">{{ column_rma_id }}</td>
                                      <td class="text-left" >{{ column_rma_date }}</td>
                                      <td class="text-left" width="12%">{{ column_item_code }}</td>
                                      <td class="text-left" width="9%">{{ column_mpn }}</td>
                                      <td class="text-center" width="180px">{{ column_apply_for_reshipment }}</td>
                                      <td class="text-center" width="160px">{{ column_apply_for_refound }}</td>
                                      <td class="text-left" >{{ column_status }}</td>
                                      <td class="text-left" >{{ column_processed_date }}</td>
                                      <td class="text-center">{{ column_process }}</td>
                                  </tr>
                                  </thead>
                                  <tbody>

                                  {% if rmas %}
                                      {% for rma in rmas %}
                                          <tr>
                                              <td class="text-center">{{ loop.index }}</td>
                                              <td class="text-left" style="word-break: break-all">
                                                  {{ rma.nickName }}
                                                  <span>
                                                    <img data-toggle="tooltip" style="padding-left: 1px"
                                                     src="{{ rma.is_home_pickup?img_home_pickup:img_drop_shipping }}"
                                                     data-original-title="{{ rma.is_home_pickup?tip_home_pickup_logo:tip_drop_shipping_logo }}">
                                                  </span>
                                              </td>
                                              <td class="text-left">{{ rma.rma_order_id }}
                                                {% if rma.marginFlag %}
                                                  <span class="flag-margin-order"><span class="giga icon-margin" data-toggle="tooltip" title="Margin"></span></span>
                                                {% endif %}
                                              </td>
                                              <td class="text-left">{{ rma.create_time }}</td>
                                              <td class="text-left" style="word-break: break-all">
                                                  {% if rma.apply_for_reshipment =='No' %}
                                                    {{ rma.refundSku }}
                                                    {% for tag_loop in rma.tag  %}
                                                      {% if tag_loop %}
                                                        {% for tagDetail in tag_loop %}
                                                          {{ tagDetail }}
                                                        {% endfor %}
                                                        </br>
                                                      {% endif %}
                                                    {% endfor %}
                                                  {% else %}
                                                    {% for tag_loop in rma.tag  %}
                                                      {% if tag_loop %}
                                                        {{ rma.sku[loop.index0] }}
                                                        {% for tagDetail in tag_loop %}
                                                          {{ tagDetail }}
                                                        {% endfor %}
                                                        </br>
                                                      {% else %}
                                                        {{ rma.sku[loop.index0] }}</br>
                                                      {% endif %}
                                                    {% endfor %}
                                                  {% endif %}
                                              </td>
                                              <td class="text-left" style="word-break: break-all">
                                                  {% if rma.apply_for_reshipment =='No' %}
                                                      {{ rma.refundMpn }}
                                                  {% else %}
                                                      {% for mpn in rma.mpn %}
                                                        {{ mpn }}</br>
                                                      {% endfor %}
                                                  {% endif %}
                                              </td>
                                              <td class="text-right" >{{ rma.apply_for_reshipment }}</td>
                                              <td class="text-left">{{ rma.apply_for_refund }}</td>
                                              <td class="text-left">
                                                  {% if rma.name == 1 %}
                                                      Applied
                                                  {% elseif rma.name == 2 %}
                                                      Processed
                                                  {% elseif rma.name == 3 %}
                                                      Pending
                                                  {% elseif rma.name == 4 %}
                                                      Canceled
                                                  {% endif %}
                                              </td>
                                              <td class="text-left">{{ rma.processed_date }}</td>
                                              <td class="text-center">
                                                  {% if rma.name == 4 %}
                                                  <a class="btn btn-primary "data-loading-text="..." disabled="true"><i class="fa fa-eye"></i></a>
                                                  {% else %}
                                                      <a class="btn btn-primary btn1"data-loading-text="..." href="{{ rmaInfo }}&rmaId={{ rma.id }}"><i class="fa fa-eye"></i></a>
                                                  {% endif %}
                                              </td>
                                          </tr>
                                      {% endfor %}
                                  {% else %}
                                      <tr>
                                          <td class="text-center" colspan="11">{{ text_no_results }}</td>
                                      </tr>
                                  {% endif %}
                                  </tbody>

                              </table>
                          </div>
                      </form>
                      <div class="row">
                          <div class="col-sm-12">
                              <div class="text-left"></div>
                              <div class="pull-right">{{ pagination }}</div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>
    <script type="text/javascript"><!--
        $('#button-filter').on('click', function() {
            url = 'index.php?route=account/customerpartner/rma_management';

            var filter_rma_id = $('input[name=\'filter_rma_id\']').val();

            if (filter_rma_id) {
                url += '&filter_rma_id=' + encodeURIComponent(filter_rma_id);
            }

            var filter_rmaDateFrom = $('input[name=\'filter_rmaDateFrom\']').val();

            if (filter_rmaDateFrom) {
                url += '&filter_rmaDateFrom=' + encodeURIComponent(filter_rmaDateFrom);
            }

            var filter_rmaDateTo = $('input[name=\'filter_rmaDateTo\']').val();

            if (filter_rmaDateTo) {
                url += '&filter_rmaDateTo=' + encodeURIComponent(filter_rmaDateTo);
            }

            var filter_mpn = $('input[name=\'filter_mpn\']').val();

            if (filter_mpn) {
                url += '&filter_mpn=' + encodeURIComponent(filter_mpn);
            }
            var filter_status = $('select[name=\'filter_status\']').val();

            if (filter_status!=0) {
                url += '&filter_status=' + encodeURIComponent(filter_status);
            }

            var filter_processedDateFrom = $('input[name=\'filter_processedDateFrom\']').val();

            if (filter_processedDateFrom) {
                url += '&filter_processedDateFrom=' + encodeURIComponent(filter_processedDateFrom);
            }

            var filter_processedDateTo = $('input[name=\'filter_processedDateTo\']').val();

            if (filter_processedDateTo) {
                url += '&filter_processedDateTo=' + encodeURIComponent(filter_processedDateTo);
            }

            var filter_item_name = $('input[name=\'filter_item_name\']').val();

            if (filter_item_name) {
                url += '&filter_item_name=' + encodeURIComponent(filter_item_name);
            }

            var filter_nick_name = $('input[name=\'filter_nick_name\']').val();

            if (filter_nick_name) {
                url += '&filter_nick_name=' + encodeURIComponent(filter_nick_name);
            }

            var filter_apply_for_reshipment = $('select[name=\'filter_apply_for_reshipment\']').val();

            if (filter_apply_for_reshipment !=-1) {
                url += '&filter_apply_for_reshipment=' + encodeURIComponent(filter_apply_for_reshipment);
            }

            var filter_apply_for_refound = $('select[name=\'filter_apply_for_refound\']').val();

            if (filter_apply_for_refound !=-1) {
                url += '&filter_apply_for_refound=' + encodeURIComponent(filter_apply_for_refound);
            }

            location = url;
        });
        //--></script>
    <script type="text/javascript"><!--
        $('.date').datetimepicker({
            pickDate: true,
            pickTime: true,
            format: 'YYYY-MM-DD HH'
        });
        $(function() {
            $(".btn1").click(function(){
                $(this).button('loading');
            });
        });
        function refilter(){
            location = '{{ current}}';
        }

        //--></script></div>
<script>
    function downloadRmaHistory() {
        url = 'index.php?route=account/customerpartner/rma_management/downloadRmaHistory';

        var filter_rma_id = $('input[name=\'filter_rma_id\']').val();

        if (filter_rma_id) {
            url += '&filter_rma_id=' + encodeURIComponent(filter_rma_id);
        }

        var filter_rmaDateFrom = $('input[name=\'filter_rmaDateFrom\']').val();

        if (filter_rmaDateFrom) {
            url += '&filter_rmaDateFrom=' + encodeURIComponent(filter_rmaDateFrom);
        }

        var filter_rmaDateTo = $('input[name=\'filter_rmaDateTo\']').val();

        if (filter_rmaDateTo) {
            url += '&filter_rmaDateTo=' + encodeURIComponent(filter_rmaDateTo);
        }

        var filter_mpn = $('input[name=\'filter_mpn\']').val();

        if (filter_mpn) {
            url += '&filter_mpn=' + encodeURIComponent(filter_mpn);
        }
        var filter_status = $('select[name=\'filter_status\']').val();

        if (filter_status!=0) {
            url += '&filter_status=' + encodeURIComponent(filter_status);
        }

        var filter_processedDateFrom = $('input[name=\'filter_processedDateFrom\']').val();

        if (filter_processedDateFrom) {
            url += '&filter_processedDateFrom=' + encodeURIComponent(filter_processedDateFrom);
        }

        var filter_processedDateTo = $('input[name=\'filter_processedDateTo\']').val();

        if (filter_processedDateTo) {
            url += '&filter_processedDateTo=' + encodeURIComponent(filter_processedDateTo);
        }

        var filter_item_name = $('input[name=\'filter_item_name\']').val();

        if (filter_item_name) {
            url += '&filter_item_name=' + encodeURIComponent(filter_item_name);
        }

        var filter_nick_name = $('input[name=\'filter_nick_name\']').val();

        if (filter_nick_name) {
            url += '&filter_nick_name=' + encodeURIComponent(filter_nick_name);
        }

        var filter_apply_for_reshipment = $('select[name=\'filter_apply_for_reshipment\']').val();

        if (filter_apply_for_reshipment !=-1) {
            url += '&filter_apply_for_reshipment=' + encodeURIComponent(filter_apply_for_reshipment);
        }

        var filter_apply_for_refound = $('select[name=\'filter_apply_for_refound\']').val();

        if (filter_apply_for_refound !=-1) {
            url += '&filter_apply_for_refound=' + encodeURIComponent(filter_apply_for_refound);
        }

        location = url;
    }
</script>
{{ footer }}