{% set titleStr = 'Accepted Language' %}
{{ this.title(titleStr) }}
{{ this.params('breadcrumbs', [
    'home',
    {
        text: 'Message Center',
        href: url('account/message_center/seller'),
    },
    {
        text: titleStr,
        href: url('account/message_center/language'),
    }
]) }}

{{ css([
  'css/common/common.css',
  'css/common/common-ext.css',
  'static/message/message-common.css',
  'static/message/buyer-message-common.css',
  'static/message/setting/language.css'
]) }}

{{ js([
  'js/common/toolString.js',
  'js/common/orisComponents.js'
]) }}

{% if separate_view is defined and separate_view %}
<div class="container-fluid" id="content" style="margin-left: 235px">
    <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
            <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
    </ul>
    {% else %}
    <div class="container" id="buyer-page-language">
        {% endif %}
        <div class="row">{{ column_left }}
            {% if column_left and column_right %}
                {% set class = 'col-sm-6' %}
            {% elseif column_left or column_right %}
                {% set class = 'col-sm-9' %}
            {% else %}
                {% set class = 'col-sm-12' %}
            {% endif %}
            {% if separate_view == 0 %}
                {% set table_div_class = 'overflow: hidden;' %}
            {% endif %}
            <div ng-app="app">
                <div id="content" class="{{ class }}">{{ content_top }}
                    {{ message_column }}
                    <div class="msgcent msg-card" style="{{ table_div_class }}">
                      <div id="page-language" class="msgcent msg-page-container">
                        <div class="header-title-container">
                          <div class="msgb msg-card__title msgcent msg-detail__header">
                            Preferred language of communication
                          </div>
                        </div>
                        <div class="content-container msgb msg-card__content">
                          <div class="msgcent msg-form__tip">
                            The language you set will determine the language you receive from the Marketplace. For example, if the language communicated is set to English, you can only receive the messages in English, not in Chinese.
                          </div>
                          <div>
                            <div class="radio-group-container">
                              <div class="radio-item">
                                <input class="radio-input oris-radio-mini" type="radio" name="type" value="0" {% if language_type == 0 %}checked="checked" {% endif %}/>
                                <span class="radio-label">All are acceptable</span>
                              </div>
                              <div class="radio-item">
                                <input class="radio-input oris-radio-mini" type="radio" name="type" value="2" {% if language_type == 2 %}checked="checked" {% endif %}/>
                                <span class="radio-label">English Only</span>
                              </div>
                              <div class="radio-item">
                                <input class="radio-input oris-radio-mini" type="radio" name="type" value="1" {% if language_type == 1 %}checked="checked" {% endif %}/>
                                <span class="radio-label">Chinese Only</span>
                              </div>
                            </div>
                          </div>

                        </div>
                        <div class="btn-container msgb msg-card__bottom">
                          <button class="oris-button-bigger oris-button oris-button-default msg-card__bottom-btn oris-w120" onclick="window.location.reload()">Cancel</button>
                          <button class="oris-button-bigger oris-button btn-item oris-w120 msg-card__bottom-btn" onclick="handleSave()">Save</button>
                        </div>
                      </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{{ footer }}

<script>
  var saveLimit = false;
  function handleSave() {
    if (saveLimit === true) {
      return ;
    }
    saveLimit = true;
    let val = $("input[name='type']:checked").val();
    block.blockUI();
    $.ajax({
      // @TODO 替换请求url
      url: "{{ url('account/message_center/language/setLanguage') }}",
      type: 'post',
      data: {type: val},
      dataType: 'json',
      success: function (json) {
        saveLimit = false
        if (json.code == 200) {
          $.toast({
            heading: false,
            text: 'Save successfully.',
            position: 'top-center',
            showHideTransition: 'fade',
            icon: 'success',
            hideAfter: 2000,
            allowToastClose: false,
            loader: false,
          });
          window.location.reload();
        } else {
          $.toast({
            heading: false,
            text: 'Save Failed! ',
            position: 'top-center',
            showHideTransition: 'fade',
            icon: 'error',
            hideAfter: 2000,
            allowToastClose: false,
            loader: false,
          });
        }
        block.unBlockUI();
      },
      error: function() {
        block.unBlockUI();
      }
    });
  }
</script>

