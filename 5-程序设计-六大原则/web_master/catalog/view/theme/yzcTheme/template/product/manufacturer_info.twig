{{ header }}
<style>
  .shadow_img{
    width: 100%;
    height: 100%;
    left: 0;
    position: absolute;
    top: 0;
    background: black;
    opacity: 0.6;
    filter:alpha(opacity=60);
    -moz-opacity:0.6;
  }
  .title_img{
    width: 100%;
    /*left: 10px;*/
    position: absolute;
    top: 40%;
    text-align: center;

  }
  .img_checkbox{
    /*left: 10px;*/
    position: absolute;
    top: 0;
    left: 0;
  }
  .con_img{
    position: relative;
    width: 100%;
    height: 228px;
    overflow: hidden;
  }
</style>
<div id="product-manufacturer" class="">
  {#菜单#}
  {% include 'giga/template/_parts/breadcrumb_simple.twig' %}
  {#END 菜单#}

  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1>{{ heading_title }}</h1>
      </div>
    </div>

    <div class="row mb-4" id="product-category">
      <div id="content" class="col-md-12">
        <div class="tab-content main">
          <div role="tabpanel" class="tab-pane active" id="content_product">
            <div class="bg-white p-2">

              {% if products %}
                <div class="filter-tool-wrapper">
                  <div class="row">
                    <div class="col-md-6 col-sm-6 hidden-xs left-btn">
                      <button type="button" id="list-view" class="btn btn-default" data-toggle="tooltip" title="{{ button_list }}"><i class="fa fa-th-list"></i></button>
                      <button type="button" id="grid-view" class="btn btn-default" data-toggle="tooltip" title="{{ button_grid }}"><i class="fa fa-th"></i></button>
                      {% if download_csv_privilege == 1 %}
                        {#13528 Product Comparsion List功能修复#}
                        <div class="checkbox ml-2 form-group input-group input-group-sm" style="margin-left: 10px;margin-top: 8px;display: inline-block;">
                          <label>
                            <input type="hidden" id="choose_product" value=''>
                            <input type="hidden" id="product" value=''>
                            <input type="checkbox" onclick="checkChoose();" id="all_products_info" value="1"
                                   style="vertical-align:middle; margin-top:0px;">
                            &nbsp;All Products Info
                          </label>
                        </div>
                        <div class="form-group input-group input-group-sm" style="display: inline-block;">
                          <button id='batch_download' mean="{{ products_to_csv }}" class="btn btn-primary btn-top"><i class="giga icon-action-download "></i>Batch Download</button>
                        </div>
                      {% else %}
                        {#13528 Product Comparsion List功能修复#}
                        <div class="form-group" style="display: none;width: 100%">
                          {#<a href="{{ compare }}" id="compare-total" class="btn btn-link">{{ text_compare }}</a>#}
                        </div>
                      {% endif %}
                    </div>

                    <div class="col-md-2 col-xs-2 pull-right">
                      <div class="form-group input-group input-group-sm select-icon">
                        <label class="input-group-addon" for="input-limit">{{ text_limit }}</label>
                        <select id="input-limit" class="form-control" onchange="location = this.value;">
                          {% for limits in limits %}
                            {% if limits.value == limit %}
                              <option value="{{ limits.href }}" selected="selected">{{ limits.text }}</option>
                            {% else %}
                              <option value="{{ limits.href }}">{{ limits.text }}</option>
                            {% endif %}
                          {% endfor %}
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4 col-xs-4 pull-right">
                      <div class="form-group input-group input-group-sm select-icon">
                        <label class="input-group-addon" for="input-sort">{{ text_sort }}</label>
                        <select id="input-sort" class="form-control" onchange="location = this.value;">
                          {% for sorts in sorts %}
                            {% if sorts.value == '%s-%s'|format(sort, order) %}
                              <option value="{{ sorts.href }}" selected="selected">{{ sorts.text }}</option>
                            {% else %}
                              <option value="{{ sorts.href }}">{{ sorts.text }}</option>
                            {% endif %}
                          {% endfor %}

                        </select>
                      </div>
                    </div>
                  </div>
                </div>



                {% for rowed in products|batch(4) %}
                  <div class="row" id="product_all_list">
                    {% for product in rowed %}
                      <div class="product-list">
                        {% include 'giga/template/_parts/product_simple_grid.twig' %}
                      </div>
                    {% endfor %}
                  </div>
                {% endfor %}



                <div class="row">
                  <div class="col-sm-12 text-right">{{ pagination }}{{ results }}</div>
                </div>


              {% else %}
                <p>{{ text_empty }}</p>
                <div class="buttons clearfix">
                  <div class="pull-right"><a href="{{ continue }}" class="btn btn-primary">{{ button_continue }}</a></div>
                </div>
              {% endif %}

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="myModal-seller-mail" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
        <h3 class="modal-title">Contact Seller</h3>
      </div>
      <form id="seller-mail-form">
        <div class="modal-body">
          <div class="form-group required">
            <label class="control-label" for="input-subject">Subject </label>
            <input type="text" name="subject" id="input-subject" class="form-control">
            <input type="hidden" name="seller" value="1">
          </div>
          <div class="form-group required">
            <label class="control-label" for="input-message">Ask </label>
            <textarea class="form-control" name="message" rows="3" id="input-message"></textarea>
          </div>
          <div class="error text-center text-danger"></div>
        </div>
      </form>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary btn-submit" id="send-mail">Send </button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div>


<script type="text/javascript" src="catalog/view/javascript/layui/layui.all.js"></script>
<link rel="stylesheet" href="catalog/view/javascript/product_category/css/jquery-labelauty.css">
<script src="catalog/view/javascript/product_category/js/jquery-labelauty.js"></script>
<script src="catalog/view/javascript/product_category/product_category.js"></script>

<script>

  $(function() {
    // 初始化内容
    $("#product_all_list input").labelauty();
    var layer = layui.layer;

    var tips;
    $('.tips').on({
      mouseenter: function () {
        var that = this;
//        var text_date = $(that).attr('text-date');
//        var text_qty = $(that).attr('text-qty');
//        tips = layer.tips("<span style='color:#000;'>Date of next arrival:&nbsp;" + text_date + "</span><br/><span style='color:#000;'>Estimated quantity of next arrival:&nbsp;" + text_qty + "</span>", that,
//          {tips: [2, '#fff'], time: 4000});
        $(that).next().show();
      },
      mouseleave: function () {
//        setTimeout(function () {
//          layer.close(tips);
//        }, 1000);
        var that = this;
        $(that).next().hide();

      }
    });
    var screenname;
    $('.screenname').on({
      mouseenter:function(){
        var that = this;
        $(this).children().eq(0).css('text-decoration','underline');
        $(this).children().css("cursor","pointer");
        var qa_rate = $(this).attr('qa_rate');
        var seller_id = $(this).attr('seller_id');
        var sku = $(this).attr('sku');
        var return_approval_rate = $(this).attr('return_approval_rate');
        if(return_approval_rate == '0'){
          //这是没有ma的
          var approval_rate_show = 'N/A' + '&nbsp;<i class="giga icon-V10-wenhaotishi" data-toggle="tooltip" style="" title="No RMA records." ></i>';
        }else{
          //验证 return_approval_rate
          if(parseFloat(return_approval_rate) > 90){
            var approval_rate_show = 'High';
          }else if(parseFloat(return_approval_rate) > 60){
            var approval_rate_show = 'Moderate';
          }else {
            var approval_rate_show = 'Low';
          }

        }


        var html = '<div style="float: left;color: #666666;padding: 10px 10px 10px 10px;">' +
//            '<div style="float: left;margin: 5px 0 5px 0;">Q&A Rate:&nbsp;'+qa_rate+'%</div><br/>' +
          '<div style="float: left;margin: 0 0 15px 0;">Return Approval Rate:&nbsp;'+approval_rate_show+'</div><br/>' +
          '<div style="float: left;border-top: 1px solid #eee;margin-bottom: 10px;width: 100%">' +
          '<button type="button" class="btn  btn-block" style="background-color: #FF7519;color: white;border-radius: 4px;margin-top: 10px;height: 35px;" onclick="getSeller('+ seller_id +')" >Store'+"'"+'s Home Page</button>' +
          '<button type="button" class="btn  btn-block" style="background-color: white;color: #FF7519;border-radius: 4px;margin-top: 10px;border: 1px solid  #FF7519;height: 35px;" onclick="getSellerContact('+ seller_id +','+"'"+ sku +"'"+')" >Contact Now</button>' +
          '</div></div>';
        screenname =layer.tips(html,that,{tips:[3,'#fff'],time:5000,area:['auto','auto']});
        $('[data-toggle="tooltip"]').tooltip();
      },
      mouseleave:function(){
        $(this).children().eq(0).css('text-decoration',"none");


      }
    });

    
    $(".to_store_home").click(function (ev) {
      if (ev.target != this) {
        return;
      } else {
        var seller_id = $(this).attr("seller_id");
        getSeller(seller_id);
      }
    });
  });

  function getSellerContact(seller_id,sku) {
    //window.location.href = 'index.php?route=message/seller/addMessage&receiver_id=' + seller_id + '&item_code=' + sku;
    var url = 'index.php?route=message/seller/addMessage&receiver_id=' + seller_id + '&item_code=' + sku;
    window.open(url,'_blank');
  }

</script>

{{ footer }}