# 请求响应-Request-Response

## 使用方法

### Request

```php
// 获取实例
$request = $this->request; // controller 和 model 中
$request = app()->get('request');
$request = request(); // 建议

// 简便操作
$value = request('getName', 'defaultValue');
$value = $request->get('name', 'defaultValue');
$value = $request->post('name', 'defaultValue');
$file = $request->file('file');
$header = $request->header('content-type');
$server = $request->server('HOST');
$allGet = $request->get();
$allPost = $request->post();
$clientIp = $request->getUserIp(); // 获取客户端 IP
$bodyBag = $request->bodyBag(); // POST body 数据，在获取 application/json 传参有用
$bodyArr = $bodyBag->asArray(); // 转为数组
$value = $bodyBag->get('a.b'); // 快速获取值
// 批量获取（若原数据中不存在该key，则该key不会在结果中）
$array = $request->get(['name1', 'name2']);
$array = $request->post(['name1', 'name2']);
// 其他详见 Framework\Http\Request 对象

// 对象封装
$query = $request->query; // $_GET 对象
$input = $request->input; // $_POST 对象
$attributes = $request->attributes; // $_REQUEST 对象
$cookie = $request->cookieBag; // $_COOKIE 对象
$file = $request->filesBag; // $_FILE 对象
$server = $request->serverBag; // $_SERVER 对象
$header = $request->headers; // $_SERVER->headers

// 常用操作
$value = $query->get('key');
$value = $input->get('key', 'default');
$has = $attributes->has('key');
$file = $file->get('file');
$language = $cookie->get('language');
$host = $server->get('HTTP_HOST');
$ua = $header->get('User-Agent');
```

### Response

```php
// 获取实例
$response = $this->response; // controller 和 model 中
$response = response(); // 推荐

// 设置header
$response->headers->set('name', 'value');
// 重定向
$response->redirectTo('account/login');
// 返回json
$response->json(['x' => 'y']);
// 浏览器下载
$response->download($file, 'filename.jpg');
// 在线显示
$response->file($file);
// 其他操作见 Symfony Response 的文档
```

## 参考

[Symfony HttpFoundation](https://symfony.com/doc/current/components/http_foundation.html): 非完全实现
