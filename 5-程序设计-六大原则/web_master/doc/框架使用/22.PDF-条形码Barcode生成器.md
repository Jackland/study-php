# PDF-Barcode生成器

用于生成 pdf 和 条形码

## 条形码生成器

```php
// 支持的生成器
$htmlGenerator = app('barcode')->html();
$pngGenerator = app('barcode')->png();
$svgGenerator = app('barcode')->svg();
$jpgGenerator = app('barcode')->jpg();
// 设置条码类型
app('barcode')->html()->type(\Picqer\Barcode\BarcodeGenerator::TYPE_CODE_11);
// 生成内容
$html = app('barcode')->html()->generate('12345678910'); // 生成 html 内容
// 生成可以直接用于 img src 的
$imgSrc = app('barcode')->generateForImgSrc('12345678910'); // 可以直接放到 <img src=""> 下
// 全部配置
app('barcode')
    ->html()
    ->type(\Picqer\Barcode\BarcodeGenerator::TYPE_CODE_11)
    ->color('#53feff')
    ->width(3)
    ->height(40)
    ->generate('12345678910');
```

### 参考

[picqer/php-barcode-generator](https://github.com/picqer/php-barcode-generator)

## DomPDF 生成器

```php
// 加载 html
$pdfString = app('dompdf')->loadHtml('<h1>hello</h1>')->generate();
// 加载 文件
$pdfString = app('dompdf')->loadFile(__DIR__ . '/a.html')->generate();
// 加载 view
$pdfString = app('dompdf')->loadView('@pdfTemplate/sales_order_pick_up_bol.twig', [
    'name' => 'my name',
])->generate();
// 设置纸张
$pdfString = app('dompdf')->setPaper('A3')->loadHtml('hello')->generate();
// 快速保存
$pdfString = app('dompdf')->setPaper('A3')->loadHtml('hello')->generate(__DIR__ . '/a.pdf');
// 输出 html
$htmlString = app('dompdf')->loadHtml('hello')->generateHtml();
// 设置配置
$pdfString = app('dompdf')->setOptions(['dpi' => 150, 'defaultFont' => 'sans-serif'])->loadHtml('hello')->generate();
// 设置字体
$pdfString = app('dompdf')->setFontFamily('宋体')->loadHtml('中文')->generate();
```

### 提示

1. setPaper / setOptions 等设置配置的，一定要在 load 之前！

2. 强制换页：

```html
<style>
.page-break {
    page-break-after: always;
}
</style>
<h1>Page 1</h1>
<div class="page-break"></div>
<h1>Page 2</h1>
```

3. 安装字体：

将需要的字体文件（.ttf）放到 public/fonts/dompdf 目录下即可

使用时通过 `app('dompdf')->setFontFamily('宋体')` 设置字体

注意字体的文件名非真实的字体名字，如 `simsun.ttf` 实际字体名为 `宋体`

可以通过命令 `php console pdf:dompdf-load-fonts` 安装所有字体（默认会自动在 `setFontFamily` 自动判断是否需要加载字体），
安装时会提示相应字体名，也可以查看 `@vendor/dompdf/dompdf/lib/fonts/dompdf_font_family_cache.php` 寻找支持的字体

### 注意点

- 支持大部分 css2.1 和 小部分 css3 （flex 不支持）

- 必须使用标准的 html 格式，如标签不闭合问题会导致生成错乱

- 其他局限性参考：[局限性](https://github.com/dompdf/dompdf#limitations-known-issues)

### 参考

[dompdf/dompdf](https://github.com/dompdf/dompdf)

## MPDF 生成器

```php
// 加载 html
$pdfString = app('mpdf')->loadHtml('<h1>hello</h1>')->generate();
// 加载 文件
$pdfString = app('mpdf')->loadFile(__DIR__ . '/a.html')->generate();
// 加载 view
$pdfString = app('mpdf')->loadView('@pdfTemplate/sales_order_pick_up_bol.twig', [
    'name' => 'my name',
])->generate();
// 快速保存
$pdfString = app('mpdf')->loadHtml('hello')->generate(__DIR__ . '/a.pdf');
// 输出 html
$htmlString = app('dompdf')->loadHtml('hello')->generateHtml();
// 设置配置
$pdfString = app('mpdf')->config([
                'margin_left' => 5,
                'margin_right' => 5,
                'margin_top' => 6,
                'margin_bottom' => 6,
            ])->loadHtml('hello')->generate();
```

### 提示

1. 默认支持所有系统字体，因此默认支持中文展示，无需单独添加字体

### 参考

[mpdf/mpdf](https://github.com/mpdf/mpdf)

[文档](https://mpdf.github.io/)

## DomPdf 和 MPdf 比较

DomPdf 优势：
  - 生成速度快于 MPdf
  - 加载特定字体有完善的机制，比较方便
  - api 配置等简单

MPdf 优势：
  - 原生支持中文（只要服务器支持即可）
  - api 配置复杂，配置丰富
  - 文档详细
  - 对 table 跨页的处理有绝对优势

## PDF 开发建议

- 开发时涉及到 table 的优先考虑 MPdf
  
- 可以同时测试用 MPdf 和 DomPdf 生成的效果，然后选择最终使用哪个

- 可以在 `src/Commands/Pdf/TestGeneratePdfCommand.php` 增加类似的测试例子，用于测试生成 pdf 文件
