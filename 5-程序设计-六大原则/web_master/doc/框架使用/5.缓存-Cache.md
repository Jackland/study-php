# 缓存-Cache

## 使用方法

```php
use Framework\Cache\Cache;
use Psr\Cache\CacheItemPoolInterface;
use Psr\SimpleCache\CacheInterface;

$app = app();
$key = 'cacheKey';
$key2 = 'cacheKey2';
$keyArr = [__CLASS__, 'name'];

// PSR16
$cache = $app->get(CacheInterface::class);
$value = $cache->get($key); // 仅支持 key 为 string
$isOk = $cache->set($key, $value); // 设置缓存，过期时间为默认
$isOk = $cache->set($key, $value, 30); // 设置缓存，过期时间未 30s
$has = $cache->has($key); // 判断存在
$isOk = $cache->delete($key); // 删除某个
$isOk = $cache->clear(); // 清空所有
$valueArr = $cache->getMultiple([$key, $key2]); // 一次获取多个
$isOk = $cache->setMultiple([$key => $value, $key2 => $value]); // 一次设置多个

// PSR16 + 集成特殊功能
$cache = $this->cache; // controller 和 model 中
$cache = $app->get('cache');
$cache = cache(); // 建议
$value = $cache->get($keyArr); // 兼容所有 psr16 接口，key 支持数组
$value = $cache->getOrSet($key, function (Cache $cache) {
    return 'xxx';
}, 30); // 存在获取，不存在则设置之后获取
$count = $cache->increment($key, 1, 30); // key 的值 +N
$count = $cache->decrement($key, 1, 30); // key 的值 -N

// PSR6
$cache = $app->get(CacheItemPoolInterface::class);
$item = $cache->getItem($key); // 获取 item，所有操作都在 item 对象中
$isOk = $cache->save($item); // 保存某个
$isOk = $cache->saveDeferred($item); // 延迟保存某个
$isOk = $cache->commit(); // 将延迟保存的 item，提交保存
$has = $cache->hasItem($key); // 判断存在
$isOk = $cache->deleteItem($key); // 删除每个
$isOk = $cache->clear(); // 清空所有
$items = $cache->getItems([$key, $key2]); // 一次获取多个
$isOk = $cache->deleteItems([$key, $key2]); // 一次删除多个
// item 对象操作
$value = $item->get(); // 获取值
$key = $item->getKey(); // 获取键
$item = $item->set($value); // 设置值
$item = $item->expiresAfter(30); // 设置 30 秒后过期
$item = $item->expiresAt(new DateTime('2020-09-03')); // 设置固定过期时间
$is = $item->isHit(); // 是否命中（存在）
```

## 参考

[PSR16 SimpleCache](https://www.php-fig.org/psr/psr-16/)

[PSR6 Cache](https://www.php-fig.org/psr/psr-6/)

[Symfony Cache](https://symfony.com/doc/current/components/cache.html)
