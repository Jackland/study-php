# 短信发送-SMS

用于系统中的短信发送

## 配置

配置文件：`config/_sms.php`，配置参数同 `easy-sms`，定义发送用的网关

环境配置：`env.example.php` 短信处，SMS_ 开头的，定义是否需要真实发送和发送的白名单控制等

模版配置：`App\Components\Sms\SmsTemplate`，定义模版和模版相关内容

Message 类构件：`App\Components\Sms\Messages` 目录下建立相关 Message

## 使用

### 发送短信

```php
use App\Components\Sms\SmsSender;
use App\Components\Sms\SmsTemplate;

// 按照 template 发送
SmsSender::sendTemplate('12345678910', SmsTemplate::CONST_KEY, ['key' => 'value']);
// 按照 message 类发送（建议）
SmsSender::sendMessage('12345678910', new SomeMessage('xxx', 'yyy'));
```

### 短信验证码相关组件

```php
use App\Components\VerifyCodeResolver;
use App\Components\Sms\Messages\PhoneVerifyMessage;
use Overtrue\EasySms\PhoneNumber;

$verifyCode = VerifyCodeResolver::sms(new PhoneNumber('12345678910', 86))
    ->setTemplate(PhoneVerifyMessage::class);
$verifyCode->send(); // 发送验证码
$verifyCode->getCorrectCode(); // 获取正确的 code
$verifyCode->verify('123456'); // 校验输入的验证码是否正确
```

## 参考

[overtrue/easy-sms](https://github.com/overtrue/easy-sms)