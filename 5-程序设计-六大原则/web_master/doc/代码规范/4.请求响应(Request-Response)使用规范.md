# 请求响应(Request-Response)使用规范

## 错误使用以及原因

1. 使用系统中原 `$this->request->get['xx']` 数组的形式

    - 指定默认值时经常需要的操作，但是如果使用数据，需要判断有则取，无则使用默认，将导致多写很多行代码
    
    - 简单的数组操作，容易出现数组越界，键不存在等问题
    
2. 使用原生 `$_GET`, `$_POST` 等操作获取数据

    - 操作简单但功能不够完善，多地方使用之后造成极大的代码冗余
    
3. Controller 中使用原 `retrunJson` 方法，未 return 的

    - 从代码上看并不知道在 returnJson 之后就 exit 退出了，会导致误解
    
## 正确的使用方式

1. 使用标准 API 操作 Request 和 Response，详见 【框架使用/请求响应-Request-Response.md】

2. Controller 中请一定 `return $response` 或 `return $content`

3. 正常情况，不允许在代码中任何地方添加 `exit`，如果不能 return 的，可以使用 `$response->send()` 来触发结束

## 注意点

1. 为了兼容旧的代码逻辑，所有 get/post 等参数获取到的值都是经过 `htmlspecialchars` 的，因此在不需要转译的地方需要使用 `htmlspecialchars_decode` 或 `html_entity_decode` 进行反向转译，
详见 `Framework\Http\Request::__construct()`
