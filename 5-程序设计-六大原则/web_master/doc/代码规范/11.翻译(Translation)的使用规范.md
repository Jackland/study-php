# 翻译(Translation)的使用规范

## 基本约定

为简化翻译的工作量，以及约束翻译的使用，做如下约定：

1. 所有新的需求，不再继续使用 `$this->language` 或 `language` 相关功能

2. 使用新的翻译方法，见 [框架使用/15.翻译-Translation]

3. 尽量不在控制器中对需要翻译的内容进行翻译，然后再传递到视图，而是应该直接在视图中通过方法翻译

4. 使用命令行(`php console translation:export`) 抽取需要翻译内容到 `resources/lang` 目录下，而非手动建立或复制文件创建（除非能非常确信自己写的和生成的结果是一致的）

5. 翻译的内容可以是文本也可以是占位符，建议直接使用中文（代码阅读性更好），这样中文的内容被抽出出来之后可以完全不做任何处理（也可以内容写英文，然后去翻译中文）

6. 由于当前产品的需求是一个一个页面进行翻译，未翻译到的页面不允许出现中文化内容，但代码中存在公用的地方（比如 Enum），因此需要把已完成或正在翻译的路由配置到 `config/__has_translated_routes.php` 下

7. 提交代码前，请确保 `php console translation:export` 不会再提取出任何的翻译内容，否则不要提交（因为其他人可能使用该命令提取出需要翻译的内容）

## 翻译category (`__()`方法的第三个参数 或 `__choice()` 方法的第四个参数)的约定

1. twig 中使用一般在顶部使用 `{% trans_default_category 'catalog/view/xxxx' %}` 的形式指定当前视图默认的 category

    - 命名的形式一般为当前视图路径（通过 `console make:view` 生成的会自动携带该设置）
    
    - 如果存在多个页面公用翻译的情况，可以考虑设置相同的默认 category
    
    - 注意：在当前 twig 页面指定的默认 category 只对当前 twig 有效，不会影响到其他，比如 `{% include %}` 的 twig 内容
    
    - 参考页面：`catalog/view/theme/yzcTheme/template/customerpartner/seller_center/index.twig`

2. 在 PHP 中的翻译，一定要指定第三个 category，命名形式一般为：

    - Controller: `controller/模块名`，比如：`controller/product`，`controller/seller_center`
    
    - 校验数据(rules验证): `validation/模块名`，比如：`validation/product`，`validation/seller_center`
    
    - Enums: `enums/目录名`，比如：`enums/buyer`，`enums/fee_order`
    
    - Repository: `repository/目录名`，比如：`repository/buyer`，`repository/fee_order`
    
    - Service: `service/目录名`，比如：`service/buyer`，`service/fee_order`
    
    - 通用的，比如 `common/upload` 等
    
    - 其他：视具体情况而定，遵循原则：命名不要过于太长，但是不能太随意（一般参考一下之前已有的翻译目录）

3. 极其不建议 category 为单独的一个单词(非目录形式)，如 `__('aa', [], 'buyer')`，请使用目录形式将内容进行归类，如 `__('aa', [], 'repositories/buyer')`

4. 针对第3点，目前仅以下情况可以写非目录形式的 category：
    
    common：表示极其通用的翻译内容
    
    
## 注意点

1. key (`__()` 的第一个参数) 和 category (`__()` 的第三个参数)不支持变量和变量拼接，请使用字符串

2. 当 key 一定需要使用变量时，请通过第二个参数替换，或者使用 `__choice()` 选择翻译